<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="static/css/home.css">
    <title>Home</title>
</head>
<body>
    <ul class="nav">
        <li id="2">Ground Water Sensor</li>
    </ul> 

    
        <div class="grid-container container" id="gridcontainer">
            <div class="grid-item box textbox">
                <div class="title" id="3">Water Height</div>
                <div class="text">{{ .Height }}m</div>
                <div class="updated">Last Updated 5m Ago</div>
            </div>
        
            <div class="grid-item box textbox">
                <div class="title">Percentage Filled</div>
                <div class="text">{{ .Percentage }}%</div>
                <div class="updated">Last Updated 5m Ago</div>
            </div>
        
            <div class="grid-item box textbox">
                <div class="title">Percentage Changed (Today)</div>
                <div class="text">{{ .Percentage_changed_sign }}{{ .Percentage_changed }}%</div>
                <div class="updated">Last Updated 5m Ago</div>
            </div>
        
            <div class="grid-item box textbox">
                <div class="title">Distance Changed (Hourly)</div>
                <div class="text">{{ .Distance_changed_sign }}{{ .Distance_changed }}m</div>
                <div class="updated">Last Updated 5m Ago</div>
            </div>
    
            <div class="grid-item box" id ="linegraphbox">
                <div id="linegraph-wrapper">
                    <canvas id="linegraph"></canvas>
                </div>

                <div style="margin-top: 20px;">
                    <label for="start-date">Start Date</label>
                    <input type="date" name="start-date" id="start-date">

                    <label for="end-date">End Date</label>
                    <input type="date" name="end-date" id="end-date">
                </div>
            </div>
        </div>

        <div class="container fixed-container">
        </div>
    
    <script>
        const labels = []
        const values = []

        const linegraph = new Chart("linegraph", {
            type: "line",
            data: {
                labels: labels,
                datasets: [{
                    label: "Percent Filled",
                    backgroundColor:"rgba(58, 152, 199,0.9)",
                    borderColor: "rgba(58, 152, 199,0.9)",
                    data: values
                }]
            },
            options:{
                maintainAspectRatio: false,
                animation: {
                   duration: 0
                }
            }  
        });

        document.getElementById("start-date").value = "{{ .Start_date }}"
        document.getElementById("end-date").value = "{{ .End_date }}"

        var linegraphbox = document.getElementById("linegraphbox")
        var gridcontainer = document.getElementById("gridcontainer")
        var linegraph_wrapper = document.getElementById("linegraph-wrapper")

        window.addEventListener("resize", resize);
        resize()

        function resize(){
            //950
            if (window.innerWidth > 950){
                linegraphbox.setAttribute("style", "grid-column: span 4;")
                gridcontainer.setAttribute("style", "height: 700px; grid-template-rows: 135px 530px;")
                linegraph_wrapper.setAttribute("style", "height: 450px;")
                //gridcontainer.style.removeProperty("grid-template-rows")
            }
            else if (window.innerWidth > 450){
                linegraphbox.setAttribute("style", "grid-column: span 2;")
                gridcontainer.setAttribute("style", "height: 900px; grid-template-rows: 135px 135px 500px;")
                linegraph_wrapper.setAttribute("style", "height: 480px;")
                gridcontainer.style.removeProperty("grid-template-rows")
            }
            else{
                linegraphbox.setAttribute("style", "grid-column: span 1;")
                gridcontainer.setAttribute("style", "grid-template-rows: repeat(4, 135px) 480px; height: auto")
                linegraph_wrapper.setAttribute("style", "height: 400px;")
            }
            

            //linegraph.reset()
        }

        /*
        function resize(){
            var elements = document.getElementsByClassName("textbox")

            if (window.innerWidth < 600){
                for (var i=0; i<elements.length; i++){
                    var width = (window.innerWidth - 20).toString() + "px"
                    //document.getElementById("2").innerText="1"

                    elements[i].setAttribute("style", "width:"+width)
                    elements[i].style.width = width
                }
            } else {
                for (var i=0; i<elements.length; i++){
                    var width = "280px"
                    //document.getElementById("2").innerText="2"

                    elements[i].setAttribute("style", "width:"+width)
                    elements[i].style.width = width
                }
            }
        }
        */

        
    </script>
</body>
</html>